// Rota para atualizar cálculo salvo
app.put('/api/saved-calculations/:id', isAuthenticated, async (req, res) => {
    try {
        const calculoId = req.params.id;
        const { data } = req.body;
        
        // Verificar se o cálculo pertence ao usuário
        const calculo = await db.get(
            'SELECT * FROM saved_calculations WHERE id = ? AND user_id = ?',
            [calculoId, req.session.userId]
        );
        
        if (!calculo) {
            return res.status(404).json({ error: 'Cálculo não encontrado' });
        }
        
        // Atualizar apenas os dados, mantendo o nome
        await db.run(
            'UPDATE saved_calculations SET data = ? WHERE id = ? AND user_id = ?',
            [JSON.stringify(data), calculoId, req.session.userId]
        );
        
        res.json({ success: true, message: 'Cálculo atualizado com sucesso' });
    } catch (error) {
        console.error('Erro ao atualizar cálculo:', error);
        res.status(500).json({ error: 'Erro ao atualizar cálculo' });
    }
});
