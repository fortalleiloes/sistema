\u003c!-- ============================================
üçé macOS Toolbar (Barra Superior)
============================================ --\u003e
\u003cdiv class="macos-toolbar"\u003e
\u003cdiv class="macos-toolbar-left"\u003e
\u003c!-- Traffic Lights (Bot√µes de Controle) --\u003e
============================================ -->
<div class="macos-toolbar">
    <div class="macos-toolbar-left">
        <!-- Traffic Lights (Bot√µes de Controle) -->
        <div class="macos-traffic-lights">
            <div class="macos-traffic-light close"></div>
            <div class="macos-traffic-light minimize"></div>
            <div class="macos-traffic-light maximize"></div>
        </div>

        <!-- T√≠tulo da P√°gina -->
        <div style="display: flex; align-items: center; gap: 8px; margin-left: 12px;">
            <img src="/images/logo-fortal.png" alt="Logo" style="height: 24px; width: auto;">
            <h1 id="macosPageTitle" class="macos-window-title" style="text-align: left; flex: none; margin: 0;">
                Fortal
            </h1>
        </div>
        \u003cdiv class="macos-toolbar-right"\u003e
        \u003c!-- Bot√£o de Busca --\u003e
        \u003cbutton class="macos-btn macos-btn-secondary" style="padding: 6px 12px;"\u003e
        \u003csvg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7
        0 0114
        0z"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003c/button\u003e

        \u003c!-- Toggle Tema (Light/Dark) --\u003e
        \u003clabel for="macos-theme-toggle" class="macos-btn macos-btn-secondary" style="padding: 6px 12px; cursor:
        pointer;"\u003e
        \u003cinput type="checkbox" id="macos-theme-toggle" style="display: none;"\u003e
        \u003csvg id="macos-theme-icon-dark" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24
        24"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646
        9.003
        9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003csvg id="macos-theme-icon-light" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24
        24"
        style="display: none;"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4
        12H3m15.364
        6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018
        0z"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003c/label\u003e

        \u003c!-- Profile Dropdown --\u003e
        \u003cdiv class="relative"\u003e
        \u003cbutton id="macosProfileBtn" class="macos-btn macos-btn-secondary" style="padding: 6px 12px;"\u003e
        \u003csvg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12
        14a7 7
        0 00-7 7h14a7 7 0 00-7-7z"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003c/button\u003e

        \u003c!-- Profile Popup --\u003e
        \u003cdiv id="macosProfilePopup" class="macos-window" style="display: none; position: absolute; right: 0; top:
        calc(100%
        + 8px); width: 280px; z-index: 9999;"\u003e
        \u003cdiv style="padding: 16px;"\u003e
        \u003cdiv style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;"\u003e
        \u003c% if (profile_pic_url) { %\u003e
        \u003cimg src="\u003c%= profile_pic_url %\u003e" alt="Foto de Perfil" style="width: 48px; height: 48px;
        border-radius:
        50%; object-fit: cover;"\u003e
        \u003c% } else { %\u003e
        \u003cdiv style="width: 48px; height: 48px; border-radius: 50%; background: var(--macos-bg-tertiary); display:
        flex;
        align-items: center; justify-content: center;"\u003e
        \u003csvg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12
        14a7 7
        0 00-7 7h14a7 7 0 00-7-7z"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003c/div\u003e
        \u003c% } %\u003e
        \u003cdiv\u003e
        \u003cp style="font-weight: 600; color: var(--macos-text-primary); font-size: 14px;"\u003e\u003c%= username
        %\u003e\u003c/p\u003e
        \u003cp style="font-size: 12px; color: var(--macos-text-secondary);"\u003e\u003c%= email %\u003e\u003c/p\u003e
        \u003c/div\u003e
        \u003c/div\u003e

        \u003cdiv class="macos-divider"\u003e\u003c/div\u003e

        \u003cnav style="display: flex; flex-direction: column; gap: 4px;"\u003e
        \u003ca href="/perfil" class="macos-sidebar-item"\u003e
        \u003cspan class="macos-sidebar-item-icon"\u003e
        \u003csvg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12
        14a7 7
        0 00-7 7h14a7 7 0 00-7-7z"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003c/span\u003e
        \u003cspan class="macos-sidebar-item-text"\u003eMeu Perfil\u003c/span\u003e
        \u003c/a\u003e

        \u003cform id="macosLogoutForm" action="/logout" method="POST" style="width: 100%;"\u003e
        \u003cbutton type="submit" class="macos-sidebar-item" style="width: 100%; border: none; background: none;
        cursor:
        pointer; color: var(--macos-red);"\u003e
        \u003cspan class="macos-sidebar-item-icon"\u003e
        \u003csvg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"\u003e
        \u003cpath stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3
        3 0 01-3
        3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"\u003e\u003c/path\u003e
        \u003c/svg\u003e
        \u003c/span\u003e
        \u003cspan class="macos-sidebar-item-text"\u003eSair\u003c/span\u003e
        \u003c/button\u003e
        \u003c/form\u003e
        \u003c/nav\u003e
        \u003c/div\u003e
        \u003c/div\u003e
        \u003c/div\u003e
        \u003c/div\u003e
        \u003c/div\u003e

        \u003cscript type="module"\u003e
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/+esm';
        const SUPABASE_URL = \u003c%= JSON.stringify(supabaseUrl || '') %\u003e;
        const SUPABASE_ANON_KEY = \u003c%= JSON.stringify(supabaseAnonKey || '') %\u003e;

        // Profile Popup Logic
        const macosProfileBtn = document.getElementById('macosProfileBtn');
        const macosProfilePopup = document.getElementById('macosProfilePopup');
        if (macosProfileBtn && macosProfilePopup) {
        macosProfileBtn.addEventListener('click', (e) =\u003e {
        e.stopPropagation();
        macosProfilePopup.style.display = macosProfilePopup.style.display === 'none' ? 'block' : 'none';
        });

        document.addEventListener('click', (e) =\u003e {
        if (macosProfilePopup.style.display !== 'none' && !macosProfilePopup.contains(e.target) &&
        !macosProfileBtn.contains(e.target)) {
        macosProfilePopup.style.display = 'none';
        }
        });
        }

        // Theme Toggle Logic
        const themeToggle = document.getElementById('macos-theme-toggle');
        const iconDark = document.getElementById('macos-theme-icon-dark');
        const iconLight = document.getElementById('macos-theme-icon-light');

        if (themeToggle && iconDark && iconLight) {
        // Carregar tema salvo
        const savedTheme = localStorage.getItem('theme') || 'dark';
        if (savedTheme === 'light') {
        document.documentElement.classList.add('light');
        themeToggle.checked = true;
        iconDark.style.display = 'none';
        iconLight.style.display = 'block';
        }

        themeToggle.addEventListener('change', () =\u003e {
        if (themeToggle.checked) {
        document.documentElement.classList.add('light');
        localStorage.setItem('theme', 'light');
        iconDark.style.display = 'none';
        iconLight.style.display = 'block';
        } else {
        document.documentElement.classList.remove('light');
        localStorage.setItem('theme', 'dark');
        iconDark.style.display = 'block';
        iconLight.style.display = 'none';
        }
        });
        }

        // Logout Logic
        if (SUPABASE_URL && SUPABASE_ANON_KEY) {
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const logoutForm = document.getElementById('macosLogoutForm');
        if (logoutForm) {
        logoutForm.addEventListener('submit', async (e) =\u003e {
        e.preventDefault();
        try {
        await supabase.auth.signOut();
        } catch (err) {
        console.error('Erro deslogando Supabase:', err);
        }
        await fetch('/logout', { method: 'POST' });
        window.location.href = '/login';
        });
        }
        }
        \u003c/script\u003e